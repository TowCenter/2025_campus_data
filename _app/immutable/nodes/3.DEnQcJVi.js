import"../chunks/CWj6FrbW.js";import"../chunks/DcQboELu.js";import{d as Ne,s as wt,o as Be,f as gn,e as Oe,b as tn}from"../chunks/C29ozPaY.js";import{C as vt,h as on,a as ln,a6 as pn,bb as yn,f as cn,ak as mn,aw as _n,b0 as bn,aY as wn,a$ as dn,U as xn,b1 as Sn,aj as Ke,A as Se,B as U,F as h,H as D,G as u,z as b,D as Me,o as t,x as Ct,y as ft,ah as E,L as K,ag as zt,a5 as un,O as rn,N as Mn,k as fn,Q as Re,bc as In,u as le,q as ce,I as ye}from"../chunks/CqUr-CmS.js";import{i as Cn}from"../chunks/BSqfaJdf.js";import{p as Q,i as st,b as Fe}from"../chunks/BCPnFxgw.js";import{r as Pe,e as Pt,i as Ht,b as k,d as an,a as Te,c as xe,s as kn,H as An,F as On}from"../chunks/D8CxgkjE.js";import{g as Dn,A as qn,c as Ft,H as Fn,B as Tn}from"../chunks/tE4jBm9l.js";import{c as en}from"../chunks/Dgjb3c1A.js";import{b as En}from"../chunks/BdCaXw6N.js";/* empty css                */import{p as nn,U as Le}from"../chunks/DvB_qBbV.js";function Rn(r,e,i=!1,a=!1,p=!1){var A=r,s="";vt(()=>{var l=pn;if(s===(s=e()??"")){on&&ln();return}if(l.nodes_start!==null&&(yn(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),s!==""){if(on){cn.data;for(var c=ln(),v=c;c!==null&&(c.nodeType!==mn||c.data!=="");)v=c,c=_n(c);if(c===null)throw bn(),wn;dn(cn,v),A=xn(c);return}var _=s+"";i?_=`<svg>${_}</svg>`:a&&(_=`<math>${_}</math>`);var q=Sn(_);if((i||a)&&(q=Ke(q)),dn(Ke(q),q.lastChild),i||a)for(;Ke(q);)A.before(Ke(q));else A.before(q)}})}function jn(r,e){e()("")}var Ln=(r,e)=>e()(r.target.value),Bn=U('<button class="clear-btn svelte-13fbzdw" aria-label="Clear search" type="button">✕</button>'),Pn=(r,e,i)=>e(t(i)),Nn=U('<button class="example-link svelte-13fbzdw" type="button"> </button>'),Qn=U('<div class="search-group search-bar-container svelte-13fbzdw"><label class="svelte-13fbzdw">Search</label> <div class="search-box-inline svelte-13fbzdw"><input type="text" placeholder="Search by keyword..." class="search-input svelte-13fbzdw" aria-label="Search by keyword"/> <!></div> <div class="example-searches svelte-13fbzdw"><span class="example-label svelte-13fbzdw">Example searches:</span> <!></div></div>');function zn(r,e){Se(e,!0);let i=Q(e,"searchQuery",3,""),a=Q(e,"onSearchChange",3,()=>{});const p=`search-input-${Math.random().toString(36).substr(2,9)}`,A=[{label:"funding cut",query:'"funding cut"'},{label:"ICE",query:'"Immigration and Customs Enforcement"'},{label:"Office of Civil Rights",query:'"Office of Civil Rights"'},{label:"visa",query:"visa"},{label:"antisemitism",query:"antisemitism"}];function s(y){a()(y.query)}var l=Qn(),c=h(l),v=D(c,2),_=h(v);Pe(_),_.__input=[Ln,a];var q=D(_,2);{var z=y=>{var M=Bn();M.__click=[jn,a],b(y,M)};st(q,y=>{i()&&y(z)})}u(v);var m=D(v,2),R=D(h(m),2);Pt(R,17,()=>A,Ht,(y,M)=>{var I=Nn();I.__click=[Pn,s,M];var x=h(I,!0);u(I),vt(()=>wt(x,t(M).label)),b(y,I)}),u(m),u(l),vt(()=>{k(c,"for",p),k(_,"id",p),an(_,i())}),b(r,l),Me()}Ne(["input","click"]);var Vn=U('<div class="export-progress svelte-16y5ceu"><div class="export-progress-bar svelte-16y5ceu"><div class="export-progress-fill svelte-16y5ceu"></div></div> <span class="export-progress-text svelte-16y5ceu"> </span></div>');function Kn(r,e){let i=Q(e,"exporting",3,!1),a=Q(e,"progress",3,0);const p=E(()=>Math.round(Math.min(Math.max(a()||0,0),1)*100));var A=Ct(),s=ft(A);{var l=c=>{var v=Vn(),_=h(v),q=h(_);u(_);var z=D(_,2),m=h(z);u(z),u(v),vt(()=>{Te(q,`width: ${t(p)}%;`),wt(m,`Exporting ${t(p)??""}%`)}),b(c,v)};st(s,c=>{i()&&c(l)})}b(r,A)}function Yn(r,e){r==null||r.stopPropagation(),e()([])}var Hn=(r,e)=>K(e,!t(e)),Un=U('<button class="clear-all-btn svelte-6qr8eg" aria-label="Clear all selections" type="button">Clear</button>'),Wn=r=>r.stopPropagation(),Gn=(r,e,i)=>e(i,r),Jn=U('<label class="checkbox-label svelte-6qr8eg" role="option"><input type="checkbox" class="svelte-6qr8eg"/> <span class="svelte-6qr8eg"> </span></label>'),Xn=U('<div class="no-results svelte-6qr8eg" role="status">No results found</div>'),Zn=U('<div class="multiselect-dropdown svelte-6qr8eg" role="listbox"><div class="dropdown-header svelte-6qr8eg"><span aria-live="polite"> </span> <!></div> <input type="text" class="dropdown-search svelte-6qr8eg" placeholder="Search..." aria-label="Search options"/> <div class="dropdown-options svelte-6qr8eg" role="group"></div></div>'),$n=U('<div class="multiselect-container svelte-6qr8eg"><label class="multiselect-label svelte-6qr8eg"> </label> <button class="multiselect-trigger svelte-6qr8eg" aria-haspopup="listbox" type="button"><span class="trigger-text svelte-6qr8eg"> </span> <span aria-hidden="true">▼</span></button> <!></div>');function tr(r,e){Se(e,!0);let i=Q(e,"label",3,"Select"),a=Q(e,"options",19,()=>[]),p=Q(e,"selectedValues",19,()=>[]),A=Q(e,"onSelectionChange",3,()=>{}),s=zt(!1),l=zt(""),c,v;function _(Y,n){n==null||n.stopPropagation();const o=p().includes(Y)?p().filter(d=>d!==Y):[...p(),Y];A()(o)}function q(){return p().length===0?"All":p().length===1?p()[0]:`${p().length} selected`}function z(){if(!t(l))return a();const Y=t(l).toLowerCase();return a().filter(n=>n.toLowerCase().includes(Y))}function m(Y){c&&!c.contains(Y.target)&&K(s,!1)}function R(Y){Y.key==="Escape"&&(K(s,!1),v==null||v.focus())}Be(()=>(document.addEventListener("click",m),document.addEventListener("keydown",R),()=>{document.removeEventListener("click",m),document.removeEventListener("keydown",R)}));var y=$n(),M=h(y),I=h(M,!0);u(M);var x=D(M,2);x.__click=[Hn,s];var w=h(x),f=h(w,!0);u(w);var F=D(w,2);let Z;u(x),Fe(x,Y=>v=Y,()=>v);var B=D(x,2);{var rt=Y=>{var n=Zn(),o=h(n),d=h(o),O=h(d);u(d);var L=D(d,2);{var W=lt=>{var gt=Un();gt.__click=[Yn,A],b(lt,gt)};st(L,lt=>{p().length>0&&lt(W)})}u(o);var V=D(o,2);Pe(V),V.__click=[Wn];var G=D(V,2);Pt(G,20,z,lt=>lt,(lt,gt)=>{var j=Jn(),H=h(j);Pe(H),H.__change=[Gn,_,gt];var P=D(H,2),et=h(P,!0);u(P),u(j),vt((at,nt)=>{k(j,"aria-selected",at),kn(H,nt),k(H,"aria-label",gt),wt(et,gt)},[()=>p().includes(gt),()=>p().includes(gt)]),b(lt,j)},lt=>{var gt=Xn();b(lt,gt)}),u(G),u(n),vt(()=>{k(n,"aria-label",`${i()??""} options`),wt(O,`${p().length??""} of ${a().length??""} selected`)}),En(V,()=>t(l),lt=>K(l,lt)),b(Y,n)};st(B,Y=>{t(s)&&Y(rt)})}u(y),Fe(y,Y=>c=Y,()=>c),vt((Y,n)=>{k(M,"for",`multiselect-trigger-${i()??""}`),wt(I,i()),k(x,"id",`multiselect-trigger-${i()??""}`),k(x,"aria-expanded",t(s)),k(x,"aria-label",`${i()??""} selector`),wt(f,Y),Z=xe(F,1,"trigger-arrow svelte-6qr8eg",null,Z,n)},[q,()=>({open:t(s)})]),b(r,y),Me()}Ne(["click","change"]);function er(r){return Array.isArray(r)?r.filter(e=>e!=null&&String(e).trim()):typeof r=="string"?r.split(",").map(e=>e.trim()).filter(e=>e):r!=null?[String(r)]:[]}Ne(["click","input","change"]);var nr=(r,e)=>K(e,!t(e)),rr=(r,e,i,a)=>{r.stopPropagation(),K(e,{...t(e),[t(i)]:!t(a)},!0)},ar=U('<span class="header-text svelte-ufcyoq"> </span>'),sr=U('<span class="header-text svelte-ufcyoq">Select Date Range</span>'),or=(r,e,i)=>e(t(i),"start",r.target.value),ir=(r,e,i)=>e(t(i),"end",r.target.value),lr=(r,e,i)=>{e(t(i),"start",""),e(t(i),"end","")},cr=U('<button class="clear-button svelte-ufcyoq" type="button">Clear Dates</button>'),dr=U('<div class="dropdown-menu date-menu svelte-ufcyoq"><div class="date-inputs svelte-ufcyoq"><label class="svelte-ufcyoq">Start Date <input type="date" class="date-input svelte-ufcyoq"/></label> <label class="svelte-ufcyoq">End Date <input type="date" class="date-input svelte-ufcyoq"/></label></div> <!></div>'),ur=U('<div class="date-range-dropdown svelte-ufcyoq"><button type="button"><!> <span class="dropdown-arrow svelte-ufcyoq"> </span></button> <!></div>'),fr=U('<div class="filter-wrapper svelte-ufcyoq"><label class="filter-header svelte-ufcyoq"> </label> <!></div>'),hr=U('<div class="filter-row-1 svelte-ufcyoq"></div>'),vr=U('<div class="search-with-help svelte-ufcyoq"><!> <div class="search-help svelte-ufcyoq"><button class="search-help-btn svelte-ufcyoq" type="button" aria-label="Search help" aria-describedby="search-help-tooltip">?</button> <div class="search-help-tooltip svelte-ufcyoq" role="tooltip" id="search-help-tooltip"><p class="svelte-ufcyoq"><strong>Single or multiple words</strong>: search with one word or several words; results rank higher when more of your words appear; multi-word searches do not require the words to appear together or in order.</p> <p class="svelte-ufcyoq"><strong>Exact phrase</strong>: use double quotes ("") to match exact wording, for example "campus safety"; note that it may take longer to process.</p></div></div></div>'),gr=U('<div><button class="mobile-toggle-btn svelte-ufcyoq" type="button"><span class="toggle-text svelte-ufcyoq"> </span> <span class="toggle-icon svelte-ufcyoq"> </span></button> <div><!> <div class="filter-row-2 svelte-ufcyoq"><!> <button class="search-btn svelte-ufcyoq" type="button">Search</button> <button class="export-btn svelte-ufcyoq" type="button"><!></button></div></div></div>');function pr(r,e){Se(e,!0);let i=Q(e,"data",19,()=>[]),a=Q(e,"filterConfig",19,()=>[]),p=Q(e,"filterValues",19,()=>({})),A=Q(e,"searchQuery",3,""),s=Q(e,"filteredRowCount",3,0),l=Q(e,"categoryDefinitions",19,()=>({})),c=Q(e,"filterOptions",19,()=>({})),v=Q(e,"isSticky",3,!1),_=Q(e,"onFilterChange",3,()=>{}),q=Q(e,"onDownloadCSV",3,()=>{}),z=Q(e,"exporting",3,!1),m=Q(e,"exportProgress",3,0);function R(g){var J;const C=(J=c())==null?void 0:J[g];if(Array.isArray(C))return C;const N=new Set;i().forEach($=>{const mt=$[g];mt&&(Array.isArray(mt)?mt.forEach(Rt=>{Rt&&N.add(String(Rt).trim())}):er(mt).forEach(At=>{At&&N.add(String(At).trim())}))});const S=Array.from(N).filter(Boolean).sort();return g==="month"?S.reverse():S}function y(g,C){if(C==="month"){const[N,S]=g.split("-");return new Date(parseInt(N),parseInt(S)-1).toLocaleString("default",{month:"long",year:"numeric"})}return g}function M(g,C){return g.type==="search"?"search":g.type==="date-range"?"filter-DateRange":g.column?`filter-${g.column}`:`filter-${g.label}`}function I(g,C,N){const S=M(g,a().indexOf(g)),J=p()[S]||{startDate:"",endDate:""};C==="start"?_()(S,{...J,startDate:N}):_()(S,{...J,endDate:N})}function x(g,C){const N=M(g,a().indexOf(g));_()(N,C)}function w(g){_()("search",g)}const f=E(()=>a().filter(g=>g.type!=="search")),F=E(()=>a().find(g=>g.type==="search"));let Z=zt(un({})),B=zt(!0),rt;function Y(g){const C=document.querySelectorAll(".date-range-dropdown");let N=!1;C.forEach(S=>{S.contains(g.target)&&(N=!0)}),N||K(Z,{},!0)}Be(()=>(document.addEventListener("click",Y),()=>{document.removeEventListener("click",Y)})),gn(()=>{});var n=gr();let o;var d=h(n);d.__click=[nr,B];var O=h(d),L=h(O,!0);u(O);var W=D(O,2),V=h(W,!0);u(W),u(d);var G=D(d,2);let lt;var gt=h(G);{var j=g=>{var C=hr();Pt(C,23,()=>t(f),(N,S)=>M(N),(N,S,J)=>{var $=fr(),mt=h($),Rt=h(mt,!0);u(mt);var At=D(mt,2);{var xt=Ot=>{const Bt=E(()=>M(t(S),t(J))),It=E(()=>p()[t(Bt)]||{startDate:"",endDate:""}),Xt=E(()=>t(Z)[t(Bt)]);var Nt=ur(),Zt=h(Nt);let pe;Zt.__click=[rr,Z,Bt,Xt];var re=h(Zt);{var $t=St=>{var Vt=ar(),Et=h(Vt);u(Vt),vt((Qt,pt)=>wt(Et,`${Qt??""} - 
										${pt??""}`),[()=>t(It).startDate?new Date(t(It).startDate).toLocaleDateString():"Start",()=>t(It).endDate?new Date(t(It).endDate).toLocaleDateString():"End"]),b(St,Vt)},T=St=>{var Vt=sr();b(St,Vt)};st(re,St=>{t(It).startDate||t(It).endDate?St($t):St(T,!1)})}var X=D(re,2),tt=h(X,!0);u(X),u(Zt);var ot=D(Zt,2);{var Dt=St=>{var Vt=dr(),Et=h(Vt),Qt=h(Et),pt=D(h(Qt));Pe(pt),pt.__change=[or,I,S],u(Qt);var _t=D(Qt,2),it=D(h(_t));Pe(it),it.__change=[ir,I,S],u(_t),u(Et);var ht=D(Et,2);{var bt=ct=>{var dt=cr();dt.__click=[lr,I,S],b(ct,dt)};st(ht,ct=>{(t(It).startDate||t(It).endDate)&&ct(bt)})}u(Vt),vt(()=>{an(pt,t(It).startDate),an(it,t(It).endDate),k(it,"min",t(It).startDate)}),b(St,Vt)};st(ot,St=>{t(Xt)&&St(Dt)})}u(Nt),vt(St=>{pe=xe(Zt,1,"dropdown-header svelte-ufcyoq",null,pe,St),wt(tt,t(Xt)?"▲":"▼")},[()=>({"has-selection":t(It).startDate||t(It).endDate})]),b(Ot,Nt)},Mt=Ot=>{var Bt=Ct(),It=ft(Bt);{var Xt=Nt=>{const Zt=E(()=>M(t(S),t(J))),pe=E(()=>p()[t(Zt)]||[]),re=E(()=>R(t(S).dataKey||t(S).column)),$t=E(()=>t(S).dataKey||t(S).column),T=E(()=>t($t)==="month"?t(re).map(Dt=>y(Dt,t($t))):t(re)),X=E(()=>t($t)==="month"?Object.fromEntries(t(re).map((Dt,St)=>[Dt,t(T)[St]])):{}),tt=E(()=>t($t)==="month"?Object.fromEntries(t(T).map((Dt,St)=>[Dt,t(re)[St]])):{}),ot=E(()=>t($t)==="month"?t(pe).map(Dt=>t(X)[Dt]??Dt):t(pe));{let Dt=E(()=>t(S).column==="Category"?l():{});tr(Nt,{label:"",get options(){return t(T)},get selectedValues(){return t(ot)},onSelectionChange:St=>{const Vt=t($t)==="month"?St.map(Et=>t(tt)[Et]??Et):St;x(t(S),Vt)},get categoryDefinitions(){return t(Dt)}})}};st(It,Nt=>{t(S).type==="multi-select"&&Nt(Xt)},!0)}b(Ot,Bt)};st(At,Ot=>{t(S).type==="date-range"?Ot(xt):Ot(Mt,!1)})}u($),vt(()=>wt(Rt,t(S).label||t(S).column)),b(N,$)}),u(C),b(g,C)};st(gt,g=>{t(f).length>0&&g(j)})}var H=D(gt,2),P=h(H);{var et=g=>{var C=vr(),N=h(C);zn(N,{get searchQuery(){return A()},onSearchChange:w}),rn(2),u(C),b(g,C)};st(P,g=>{t(F)&&g(et)})}var at=D(P,2),nt=D(at,2);nt.__click=function(...g){var C;(C=q())==null||C.apply(this,g)};var yt=h(nt);{var ut=g=>{Kn(g,{get exporting(){return z()},get progress(){return m()}})},kt=g=>{var C=Mn("Export");b(g,C)};st(yt,g=>{z()?g(ut):g(kt,!1)})}u(nt),u(H),u(G),u(n),Fe(n,g=>rt=g,()=>rt),vt((g,C)=>{o=xe(n,1,"filter-bar svelte-ufcyoq",null,o,g),k(d,"aria-label",t(B)?"Expand filters":"Collapse filters"),k(d,"aria-expanded",!t(B)),wt(L,t(B)?"Show Filters":"Hide Filters"),wt(V,t(B)?"▼":"▲"),lt=xe(G,1,"filter-content svelte-ufcyoq",null,lt,C),k(at,"aria-label",`Search ${s()??""} items`),k(nt,"aria-label",`Export ${s()??""} items`),nt.disabled=z()},[()=>({sticky:v()}),()=>({collapsed:t(B)})]),b(r,n),Me()}Ne(["click","change"]);const yr=new Map;function mr(r,e,i=1e3){return function(...a){const p=JSON.stringify(a);if(e.has(p))return e.get(p);const A=r.apply(this,a);if(e.set(p,A),e.size>i){const s=e.keys().next().value;e.delete(s)}return A}}function _r(r){if(!r)return new Date(0);const e=String(r).trim(),[i,a,p]=e.split("-");return i&&a&&p?new Date(parseInt(i),parseInt(a)-1,parseInt(p)):new Date(e)}const qe=mr(_r,yr,500);function br(r,e="date"){const i={};r.forEach(p=>{const A=p[e];if(!A)return;const s=qe(A);if(isNaN(s.getTime()))return;const l=`${s.toLocaleString("default",{month:"long"})} ${s.getFullYear()}`;i[l]=i[l]||[],i[l].push(p)}),Object.keys(i).forEach(p=>{i[p].sort((A,s)=>{const l=qe(A[e]);return qe(s[e]).getTime()-l.getTime()})});const a={};return Object.keys(i).sort((p,A)=>{const s=i[p][0],l=i[A][0];if(!s||!l)return 0;const c=qe(s[e]);return qe(l[e]).getTime()-c.getTime()}).forEach(p=>{a[p]=i[p]}),a}var wr=(r,e)=>e(!e()),xr=Re('<line stroke="#f0f0f0" stroke-width="1"></line><line stroke="#333" stroke-width="1"></line><text class="axis-label svelte-18qsu26" text-anchor="end"> </text>',1),Sr=Re('<text class="axis-label svelte-18qsu26" text-anchor="middle"> </text>'),Mr=Re('<line stroke="#333" stroke-width="1"></line><!>',1),Ir=Re('<circle r="5" fill="#254c6f" stroke="white" stroke-width="2" class="data-point svelte-18qsu26"></circle>'),Cr=U('<div class="line-tooltip svelte-18qsu26"><div class="tooltip-date svelte-18qsu26"> </div> <div class="tooltip-value svelte-18qsu26"> </div></div>'),kr=Re('<line stroke="#f0f0f0" stroke-width="1"></line><line stroke="#333" stroke-width="1"></line><text class="axis-label svelte-18qsu26" text-anchor="middle"> </text>',1),Ar=Re('<g class="bar-group svelte-18qsu26" role="button" tabindex="0"><text class="bar-org-label-svg svelte-18qsu26" text-anchor="end"> </text><rect fill="#f0f0f0" rx="4"></rect><rect rx="4" class="bar-fill-rect svelte-18qsu26"></rect></g>'),Or=U('<div class="bar-tooltip svelte-18qsu26"><div class="tooltip-org svelte-18qsu26"> </div> <div class="tooltip-count svelte-18qsu26"> </div></div>'),Dr=U('<div class="search-charts-container svelte-18qsu26"><div class="charts-stats-header svelte-18qsu26"><div class="stat-item svelte-18qsu26"><div class="stat-value svelte-18qsu26"> </div> <div class="stat-label svelte-18qsu26">Schools</div></div> <div class="stat-item svelte-18qsu26"><div class="stat-value svelte-18qsu26"> </div> <div class="stat-label svelte-18qsu26">Records</div></div></div> <button class="charts-toggle mobile-only svelte-18qsu26" type="button"><span class="toggle-text"> </span></button> <div><div class="charts-panel svelte-18qsu26"><div class="charts-grid svelte-18qsu26"><div class="chart-section line-chart-section svelte-18qsu26"><h4 class="chart-title svelte-18qsu26">Activity Over Time</h4> <div class="line-chart-wrapper svelte-18qsu26"><svg class="line-chart svelte-18qsu26" preserveAspectRatio="xMidYMid meet"><!><line stroke="#333" stroke-width="1"></line><!><line stroke="#333" stroke-width="1"></line><path fill="none" stroke="#254c6f" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="total-line svelte-18qsu26"></path><!></svg> <!></div></div> <div class="chart-section bar-chart-section svelte-18qsu26"><h4 class="chart-title svelte-18qsu26">Top 5 Schools</h4> <div class="bar-chart-wrapper svelte-18qsu26"><svg class="bar-chart-svg svelte-18qsu26" preserveAspectRatio="xMidYMid meet"><!><line stroke="#333" stroke-width="1"></line><line stroke="#333" stroke-width="1"></line><!></svg> <!></div></div></div></div></div></div>');function qr(r,e){Se(e,!0);let i=Q(e,"data",19,()=>[]),a=Q(e,"dateField",3,"date"),p=Q(e,"orgField",3,"org"),A=Q(e,"searchQuery",3,""),s=Q(e,"isOpen",15,!1),l=Q(e,"stats",3,null);fn(()=>{A()&&A().length>0&&s(!0)});const c=E(()=>l()&&typeof l().totalRecords=="number"?l().totalRecords>0:i().length>0);let v=zt(null),_=zt(null),q=zt(0),z=zt(0);function m(P){return P>=1e3?Math.round(P/1e3)+"k":Math.round(P).toString()}function R(P){if(P<=0)return[0];const et=[5,10,20,25,50,100,200,250,500,1e3];let at=10;for(const ut of et){const kt=Math.ceil(P/ut);if(kt>=3&&kt<=6){at=ut;break}}const nt=Math.ceil(P/at)*at,yt=[];for(let ut=0;ut<=nt;ut+=at)yt.push(ut);return yt}const y=E(()=>{if(l()&&(l().monthlyCounts||l().institutionCounts||l().topInstitutions)){const S=l().monthlyCounts||{},$=Object.keys(S).sort().map(Ot=>{const[Bt,It]=Ot.split("-"),Xt=new Date(parseInt(Bt,10),parseInt(It,10)-1);return{key:Ot,label:Xt.toLocaleString("default",{month:"short",year:"2-digit"})}}),mt=Array.isArray(l().topInstitutions)&&l().topInstitutions.length>0?l().topInstitutions:Object.entries(l().institutionCounts||{}).sort((Ot,Bt)=>Bt[1]-Ot[1]).slice(0,5).map(([Ot,Bt])=>({org:Ot,count:Bt})),Rt=Math.max(1,...Object.values(S)),At=mt.length>0?mt[0].count:1,xt=typeof l().totalSchools=="number"?l().totalSchools:Object.values(l().institutionCounts||{}).filter(Ot=>Ot>0).length,Mt=typeof l().totalRecords=="number"?l().totalRecords:0;return{monthlyByOrg:{},monthlyTotal:S,monthLabels:$,top5Orgs:mt,maxMonthlyTotal:Rt,maxOrgCount:At,allOrgs:[],totalSchools:xt,totalRecords:Mt}}const P={},et={},at={};i().forEach(S=>{const J=S[a()];if(!J)return;const $=qe(J);if(isNaN($.getTime()))return;const mt=$.getFullYear(),Rt=$.getMonth(),At=`${mt}-${String(Rt+1).padStart(2,"0")}`;(Array.isArray(S[p()])?S[p()]:[S[p()]]).forEach(Mt=>{Mt&&(at[Mt]=(at[Mt]||0)+1,P[Mt]||(P[Mt]={}),P[Mt][At]=(P[Mt][At]||0)+1)}),et[At]=(et[At]||0)+1});const nt=[...new Set([...Object.keys(et),...Object.values(P).flatMap(S=>Object.keys(S))])].sort(),yt=Object.entries(at).sort((S,J)=>J[1]-S[1]).slice(0,5).map(([S,J])=>({org:S,count:J})),ut=nt.map(S=>{const[J,$]=S.split("-"),mt=new Date(parseInt(J),parseInt($)-1);return{key:S,label:mt.toLocaleString("default",{month:"short",year:"2-digit"})}}),kt=Math.max(1,...Object.values(et)),g=yt.length>0?yt[0].count:1,C=Object.keys(at).length,N=i().length;return{monthlyByOrg:P,monthlyTotal:et,monthLabels:ut,top5Orgs:yt,maxMonthlyTotal:kt,maxOrgCount:g,allOrgs:Object.keys(at),totalSchools:C,totalRecords:N}});function M(P,et,at,nt,yt,ut){return!P||et.length===0?"":`M ${et.map((g,C)=>{const N=ut+C/(et.length-1||1)*(nt-2*ut),S=P[g.key]||0,J=yt-ut-S/at*(yt-2*ut);return`${N},${J}`}).join(" L ")}`}function I(P,et,at,nt,yt,ut){return!P||et.length===0?[]:et.map((kt,g)=>{const C=ut+g/(et.length-1||1)*(nt-2*ut),N=P[kt.key]||0,S=yt-ut-N/at*(yt-2*ut);return{x:C,y:S,value:N,label:kt.label}})}const x=500,w=220,f=50,F=450,Z=200,B={top:10,right:20,bottom:40,left:140},rt=24,Y=10,n=E(()=>R(t(y).maxMonthlyTotal)),o=E(()=>t(n)[t(n).length-1]||t(y).maxMonthlyTotal),d=E(()=>R(t(y).maxOrgCount)),O=E(()=>t(d)[t(d).length-1]||t(y).maxOrgCount),L=E(()=>M(t(y).monthlyTotal,t(y).monthLabels,t(o),x,w,f)),W=E(()=>I(t(y).monthlyTotal,t(y).monthLabels,t(o),x,w,f));let V;function G(P,et){if(K(_,P,!0),V){const at=V.getBoundingClientRect();K(q,et.clientX-at.left),K(z,et.clientY-at.top-40)}}function lt(){K(_,null)}var gt=Ct(),j=ft(gt);{var H=P=>{var et=Dr(),at=h(et),nt=h(at),yt=h(nt),ut=h(yt,!0);u(yt),rn(2),u(nt);var kt=D(nt,2),g=h(kt),C=h(g,!0);u(g),rn(2),u(kt),u(at);var N=D(at,2);N.__click=[wr,s];var S=h(N),J=h(S);u(S),u(N);var $=D(N,2);let mt;var Rt=h($),At=h(Rt),xt=h(At),Mt=D(h(xt),2),Ot=h(Mt);k(Ot,"viewBox","0 0 500 220");var Bt=h(Ot);Pt(Bt,17,()=>t(n),Ht,(pt,_t)=>{const it=E(()=>w-f-t(_t)/t(o)*(w-2*f));var ht=xr(),bt=ft(ht);k(bt,"x1",f),k(bt,"x2",x-f);var ct=D(bt);k(ct,"x1",f-5),k(ct,"x2",f);var dt=D(ct);k(dt,"x",f-12);var qt=h(dt,!0);u(dt),vt(Tt=>{k(bt,"y1",t(it)),k(bt,"y2",t(it)),k(ct,"y1",t(it)),k(ct,"y2",t(it)),k(dt,"y",t(it)+4),wt(qt,Tt)},[()=>m(t(_t))]),b(pt,ht)});var It=D(Bt);k(It,"x1",f),k(It,"y1",f),k(It,"x2",f),k(It,"y2",w-f);var Xt=D(It);Pt(Xt,17,()=>t(y).monthLabels,Ht,(pt,_t,it)=>{const ht=E(()=>f+it/(t(y).monthLabels.length-1||1)*(x-2*f));var bt=Mr(),ct=ft(bt);k(ct,"y1",w-f),k(ct,"y2",w-f+5);var dt=D(ct);{var qt=Tt=>{var Ut=Sr();k(Ut,"y",w-f+18);var Lt=h(Ut,!0);u(Ut),vt(()=>{k(Ut,"x",t(ht)),wt(Lt,t(_t).label)}),b(Tt,Ut)};st(dt,Tt=>{(it%Math.ceil(t(y).monthLabels.length/5)===0||it===t(y).monthLabels.length-1)&&Tt(qt)})}vt(()=>{k(ct,"x1",t(ht)),k(ct,"x2",t(ht))}),b(pt,bt)});var Nt=D(Xt);k(Nt,"x1",f),k(Nt,"y1",w-f),k(Nt,"x2",x-f),k(Nt,"y2",w-f);var Zt=D(Nt),pe=D(Zt);Pt(pe,17,()=>t(W),Ht,(pt,_t)=>{var it=Ir();vt(()=>{k(it,"cx",t(_t).x),k(it,"cy",t(_t).y)}),Oe("mouseenter",it,ht=>G(t(_t),ht)),Oe("mouseleave",it,lt),b(pt,it)}),u(Ot);var re=D(Ot,2);{var $t=pt=>{var _t=Cr(),it=h(_t),ht=h(it,!0);u(it);var bt=D(it,2),ct=h(bt);u(bt),u(_t),vt(dt=>{Te(_t,`left: ${t(q)??""}px; top: ${t(z)??""}px;`),wt(ht,t(_).label),wt(ct,`${dt??""} announcements`)},[()=>t(_).value.toLocaleString()]),b(pt,_t)};st(re,pt=>{t(_)&&pt($t)})}u(Mt),Fe(Mt,pt=>V=pt,()=>V),u(xt);var T=D(xt,2),X=D(h(T),2),tt=h(X);k(tt,"viewBox","0 0 450 200");var ot=h(tt);Pt(ot,17,()=>t(d),Ht,(pt,_t)=>{const it=E(()=>B.left+t(_t)/t(O)*(F-B.left-B.right));var ht=kr(),bt=ft(ht),ct=D(bt),dt=D(ct),qt=h(dt,!0);u(dt),vt(Tt=>{k(bt,"x1",t(it)),k(bt,"y1",B.top),k(bt,"x2",t(it)),k(bt,"y2",Z-B.bottom),k(ct,"x1",t(it)),k(ct,"y1",Z-B.bottom),k(ct,"x2",t(it)),k(ct,"y2",Z-B.bottom+5),k(dt,"x",t(it)),k(dt,"y",Z-B.bottom+18),wt(qt,Tt)},[()=>m(t(_t))]),b(pt,ht)});var Dt=D(ot),St=D(Dt),Vt=D(St);Pt(Vt,17,()=>t(y).top5Orgs,Ht,(pt,_t,it)=>{let ht=()=>t(_t).org,bt=()=>t(_t).count;const ct=E(()=>bt()/t(O)*(F-B.left-B.right)),dt=E(()=>B.top+it*(rt+Y));var qt=Ar(),Tt=h(qt),Ut=h(Tt,!0);u(Tt);var Lt=D(Tt);k(Lt,"height",rt);var Kt=D(Lt);k(Kt,"height",rt),u(qt),vt(de=>{k(Tt,"x",B.left-8),k(Tt,"y",t(dt)+rt/2+4),wt(Ut,de),k(Lt,"x",B.left),k(Lt,"y",t(dt)),k(Lt,"width",F-B.left-B.right),k(Kt,"x",B.left),k(Kt,"y",t(dt)),k(Kt,"width",t(ct)),k(Kt,"fill",t(v)===ht()?"#1a3a52":"#254c6f")},[()=>ht().length>18?ht().substring(0,18)+"...":ht()]),Oe("mouseenter",qt,()=>K(v,ht(),!0)),Oe("mouseleave",qt,()=>K(v,null)),Oe("focus",qt,()=>K(v,ht(),!0)),Oe("blur",qt,()=>K(v,null)),b(pt,qt)}),u(tt);var Et=D(tt,2);{var Qt=pt=>{const _t=E(()=>t(y).top5Orgs.find(dt=>dt.org===t(v))),it=E(()=>t(y).top5Orgs.findIndex(dt=>dt.org===t(v)));var ht=Ct(),bt=ft(ht);{var ct=dt=>{var qt=Or(),Tt=h(qt),Ut=h(Tt,!0);u(Tt);var Lt=D(Tt,2),Kt=h(Lt);u(Lt),u(qt),vt(de=>{Te(qt,`top: ${B.top+t(it)*(rt+Y)-40}px; left: calc(50% + 70px);`),wt(Ut,t(_t).org),wt(Kt,`${de??""} announcements`)},[()=>t(_t).count.toLocaleString()]),b(dt,qt)};st(bt,dt=>{t(_t)&&dt(ct)})}b(pt,ht)};st(Et,pt=>{t(v)&&pt(Qt)})}u(X),u(T),u(At),u(Rt),u($),u(et),vt((pt,_t)=>{wt(ut,t(y).totalSchools),wt(C,pt),k(N,"aria-expanded",s()),wt(J,`Charts ${s()?"▲":"▼"}`),mt=xe($,1,"charts-panel-wrapper svelte-18qsu26",null,mt,_t),k(Zt,"d",t(L)),k(Dt,"x1",B.left),k(Dt,"y1",Z-B.bottom),k(Dt,"x2",F-B.right),k(Dt,"y2",Z-B.bottom),k(St,"x1",B.left),k(St,"y1",B.top),k(St,"x2",B.left),k(St,"y2",Z-B.bottom)},[()=>t(y).totalRecords.toLocaleString(),()=>({"mobile-open":s()})]),b(P,et)};st(j,P=>{t(c)&&P(H)})}b(r,gt),Me()}Ne(["click"]);var Fr=U('<span class="spinner-label svelte-yq4eav"> </span>'),Tr=U('<p class="loading-note svelte-yq4eav"> </p>'),Er=U('<div class="loading svelte-yq4eav"><div class="spinner svelte-yq4eav"><div class="spinner-ring svelte-yq4eav"></div> <!></div> <p class="svelte-yq4eav"> </p> <!></div>');function Rr(r,e){let i=Q(e,"loading",3,!1),a=Q(e,"progress",3,0),p=Q(e,"showProgress",3,!1),A=Q(e,"label",3,"Loading database..."),s=Q(e,"note",3,"");const l=E(()=>Math.round(Math.min(Math.max(a()||0,0),1)*100));var c=Ct(),v=ft(c);{var _=q=>{var z=Er(),m=h(z),R=D(h(m),2);{var y=f=>{var F=Fr(),Z=h(F);u(F),vt(()=>wt(Z,`${t(l)??""}%`)),b(f,F)};st(R,f=>{p()&&f(y)})}u(m);var M=D(m,2),I=h(M,!0);u(M);var x=D(M,2);{var w=f=>{var F=Tr(),Z=h(F,!0);u(F),vt(()=>wt(Z,s())),b(f,F)};st(x,f=>{s()&&f(w)})}u(z),vt(()=>wt(I,A())),b(q,z)};st(v,q=>{i()&&q(_)})}b(r,c)}const hn=r=>String(r||"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),De=r=>r?String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):"",Ee=r=>(r||"").trim().toLowerCase().split(/\s+/).map(e=>e.replace(/^\"+|\"+$/g,"")).filter(Boolean),sn=r=>{const i=(r||"").trim().match(/^\"(.*)\"$/);return i&&i[1].trim()||null},He=(r,e="gi")=>{const i=Ee(r);if(!i.length)return null;const a=i.map(p=>{const A=hn(p);return/^[a-z0-9]+$/i.test(p)?`\\b${A}\\b`:A});return new RegExp(`(${a.join("|")})`,e)},Ue=(r,e="gi")=>{const i=Ee(r);if(i.length<2)return null;const a=i.map(p=>{const A=hn(p);return/^[a-z0-9]+$/i.test(p)?`\\b${A}\\b`:A});return new RegExp(`(${a.join("\\s+")})`,e)},jr=(r,e)=>{if(!r)return"";const i=sn(e);if(i){const l=Ue(i,"gi"),c=He(i,"gi"),v=l||c;return v?String(r).split(v).map((q,z)=>z%2===1?`<mark>${De(q)}</mark>`:De(q)).join(""):De(r)}const a=Ue(e,"gi"),p=He(e,"gi");if(!p)return De(r);let A=p;return a&&(a.lastIndex=0,a.test(String(r))&&(A=a),a.lastIndex=0),String(r).split(A).map((l,c)=>c%2===1?`<mark>${De(l)}</mark>`:De(l)).join("")},Lr=(r,e,i=240,a=100)=>{if(!r)return"";const p=()=>{let n=String(r).slice(0,i);const o=n.lastIndexOf(" ");return o>0&&String(r).length>i?(n=n.slice(0,o),n+"..."):String(r).length>i?n+"...":n},A=Ue(e,"i"),s=He(e,"i"),l=30;if(!A&&!s)return p();const c=n=>{if(!n)return[];const o=n.flags.includes("g")?n.flags:`${n.flags}g`,d=new RegExp(n.source,o),O=[];let L;for(;(L=d.exec(String(r)))!==null;)O.push({index:L.index,length:L[0].length,text:L[0]}),L[0].length===0&&(d.lastIndex+=1);return O},v=(n,o)=>{let d=Math.max(0,n),O=Math.min(String(r).length,o);if(d>0){const L=String(r).lastIndexOf(" ",d);L!==-1&&(d=L+1)}if(O<String(r).length){const L=String(r).indexOf(" ",O);L!==-1&&(O=L)}return{start:d,end:O}},_=(n,o,d=!0,O=!0)=>{const{start:L,end:W}=v(n,o);let V=String(r).slice(L,W);return L>0&&d&&(V="..."+V),W<String(r).length&&O&&(V=V+"..."),V},q=(n,o)=>{if(n.length<=o)return n;let d=n.slice(0,Math.max(0,o-1));const O=d.lastIndexOf(" ");return O>0&&O>d.length-20&&(d=d.slice(0,O)),d.replace(/\.{0,3}$/,"")+"..."},z=(n,o)=>{const d=[...n].sort((V,G)=>V.index-G.index),O=[];let L=d[0].index-o,W=d[0].index+d[0].length+o;for(let V=1;V<d.length;V++){const G=d[V],lt=G.index-o,gt=G.index+G.length+o;lt<=W?W=Math.max(W,gt):(O.push(v(L,W)),L=lt,W=gt)}return O.push(v(L,W)),O},m=n=>n.reduce((o,d,O)=>{const L=d.end-d.start,W=d.start>0?1:0,V=d.end<String(r).length?1:0,G=O>0?1:0;return o+L+W+V+G},0),R=c(A);if(R.length>0){const{index:n,length:o}=R[0];let d=_(n-a,n+o+a);return d.length>i&&(d=q(d,i)),d}const y=c(s);if(!y.length)return p();const M=new Set(Ee(e).map(n=>n.toLowerCase()));let I=Math.min(a,Math.floor(i/Math.max(y.length,1)/2));I=Math.max(l,I);let x=z(y,I);for(;x.length>1&&I>l&&!(m(x)<=i);){const o=Math.max(l,Math.floor(I*.75));if(o===I)break;I=o,x=z(y,I)}const w=x.map(()=>new Set);y.forEach(n=>{const o=n.text?n.text.toLowerCase():"";if(!M.has(o))return;const d=x.findIndex(O=>n.index>=O.start&&n.index<=O.end);d!==-1&&w[d].add(o)});const f=[],F=[],Z=new Set;x.forEach((n,o)=>{const d=w[o];Array.from(d).some(L=>!Z.has(L))?(d.forEach(L=>Z.add(L)),f.push({seg:n,idx:o})):F.push({seg:n,idx:o})});const B=[...f,...F];let rt=i;const Y=[];for(let n=0;n<B.length&&rt>0;n++){const{seg:o}=B[n],d=Y.length?" ":"",O=rt-d.length;if(O<=0)break;let L=_(o.start,o.end,!0,!0);L.length>O&&(L=q(L,O)),L&&(Y.push(L),rt-=L.length+d.length)}return Y.length?Y.join(" "):p()};var Br=U('<div class="sticky-spacer svelte-17yoswn"></div>'),Pr=U('<div class="search-charts-wrapper svelte-17yoswn"><!></div>'),Nr=U('<span class="cue-label svelte-17yoswn">Matching exact phrase</span> <span class="cue-term svelte-17yoswn"> </span>',1),Qr=U('<span class="cue-operator svelte-17yoswn">OR</span>'),zr=U('<!> <span class="cue-term svelte-17yoswn"> </span>',1),Vr=U('<span class="cue-label svelte-17yoswn">Matching</span> <!>',1),Kr=U('<span class="cue-label svelte-17yoswn">Matching</span> <span class="cue-term svelte-17yoswn"> </span>',1),Yr=U('<div class="search-query-cue svelte-17yoswn"><!> <span class="cue-count svelte-17yoswn"> </span></div>'),Hr=U('<div class="no-data-message svelte-17yoswn"><p>No results found.</p></div>'),Ur=U('<div class="timeline-row svelte-17yoswn"><div class="timeline-date svelte-17yoswn"><div class="date-tag svelte-17yoswn"><span class="date-month-day svelte-17yoswn"> </span> <span class="date-year svelte-17yoswn"> </span></div></div> <div class="timeline-divider svelte-17yoswn"></div> <div class="timeline-content svelte-17yoswn"><!></div></div>'),Wr=U('<table class="data-table svelte-17yoswn"><thead><tr><th class="table-header svelte-17yoswn">Date</th><th class="table-header svelte-17yoswn">School</th><th class="table-header svelte-17yoswn">Content</th></tr></thead><tbody><!></tbody></table>'),Gr=U('<p class="loading svelte-17yoswn">Loading more...</p>'),Jr=U('<div class="infinite-sentinel svelte-17yoswn" aria-hidden="true"></div>'),Xr=U("<div><!> <!> <!></div>"),Zr=U("<!> <!>",1),$r=U('<div class="no-data-message svelte-17yoswn"><p>Use the filters to search announcements</p></div>'),ta=U('<div class="data-wrapper svelte-17yoswn"><div><!></div> <!> <!> <!></div>');function ea(r,e){Se(e,!0);let i=Q(e,"data",19,()=>[]),a=Q(e,"categoryDefinitions",19,()=>({})),p=Q(e,"filterConfig",3,void 0),A=Q(e,"filterOptions",19,()=>({})),s=Q(e,"dateField",3,"date"),l=Q(e,"itemComponent",3,void 0),c=Q(e,"displayMode",3,"list"),v=Q(e,"showTimeline",3,!1);Q(e,"showYearNavigation",3,!1);let _=Q(e,"hasMore",3,!1),q=Q(e,"totalCount",3,null),z=Q(e,"onLoadMore",3,async()=>{}),m=Q(e,"onFiltersChange",3,()=>{}),R=Q(e,"chartStats",3,null),y=Q(e,"searchState",3,null),M=Q(e,"exportState",3,null),I=Q(e,"resultsLoading",3,!1),x=Q(e,"appliedSearchQuery",3,null),w=Q(e,"onDownloadCSV",3,()=>{}),f=Q(e,"children",3,void 0),F=zt(un({})),Z=zt(""),B=zt(!1);const rt=E(()=>x()!==null&&x()!==void 0?x():t(Z)),Y=E(()=>{const T=t(rt)&&t(rt).trim().length>0,X=Object.entries(t(F)).some(([tt,ot])=>tt==="search"?!1:Array.isArray(ot)?ot.length>0:ot&&typeof ot=="object"?Object.values(ot).some(Dt=>Dt):!!ot);return T||X});let n,o=zt(!1),d=0,O=zt(0),L=zt(0),W=zt(0);function V(T){if(!T)return null;try{const X=new Date(T);if(isNaN(X.getTime()))return null;const tt=X.getFullYear(),ot=X.getMonth();return`${tt}-${String(ot+1).padStart(2,"0")}`}catch{return null}}let G=zt(null);const lt=[{type:"multi-select",column:"Institution",label:"Institution",dataKey:"org"},{type:"multi-select",column:"Month",label:"Month",dataKey:"month",virtual:!0},{type:"multi-select",column:"Category",label:"Category",dataKey:"category"},{type:"search",label:"Search"}],gt=E(()=>p()||lt),j=E(()=>i().map(T=>({...T,month:V(T[s()])}))),H=E(()=>sn(t(rt))),P=E(()=>!!t(H)),et=E(()=>Ee((t(rt)||"").trim()));function at(T,X){const tt={...t(F),[T]:X},ot=T==="search"?X:t(Z);K(F,tt,!0),T==="search"&&K(Z,X,!0),m()({filterValues:tt,searchQuery:ot})}async function nt(){if(!(t(B)||!_())){K(B,!0);try{await z()()}finally{K(B,!1)}}}fn(()=>{if(typeof window>"u"||!t(G)||!_()||typeof IntersectionObserver>"u")return;const T=new IntersectionObserver(X=>{X.some(tt=>tt.isIntersecting)&&nt()},{rootMargin:"200px"});return T.observe(t(G)),()=>{T.disconnect()}});function yt(){if(typeof window>"u")return;const T=window.scrollY||window.pageYOffset;if(d>0){const X=t(o),tt=5;if(X)K(o,T>=d-tt),!t(o)&&n&&setTimeout(()=>{if(n&&!t(o)){const ot=n.getBoundingClientRect();K(L,ot.width,!0),K(W,ot.left,!0)}},50);else{if(T>=d&&n){const ot=n.getBoundingClientRect();t(L)===0&&K(L,ot.width,!0),t(W)===0&&K(W,ot.left,!0)}K(o,T>=d)}if(t(o)&&(!X||t(O)===0)&&n){const ot=n.getBoundingClientRect();K(O,ot.height,!0)}}else if(n&&!t(o)){const X=n.getBoundingClientRect();d=X.top+T,K(L,X.width,!0),K(W,X.left,!0),K(o,T>=d),t(o)&&K(O,X.height,!0)}}const ut=E(()=>t(j)),kt=E(()=>typeof q()=="number"?q():t(ut).length),g=E(()=>{var T;return!!((T=y())!=null&&T.loading)}),C=E(()=>{var T;return Number(((T=y())==null?void 0:T.progress)||0)}),N=E(()=>{var T;return!!((T=y())!=null&&T.exactMatchActive)}),S=E(()=>{var T;return!!((T=M())!=null&&T.exporting)}),J=E(()=>{var T;return Number(((T=M())==null?void 0:T.progress)||0)}),$=E(()=>!!(t(g)||I())),mt=E(()=>t(g)?t(C):1),Rt=E(()=>v()?br(t(ut),s()):{}),At=E(()=>{if(v()){const T=t(Rt),X=[];for(const[tt,ot]of Object.entries(T))for(const Dt of ot)X.push({...Dt,dateKey:tt});return X}else return[...t(ut)].sort((X,tt)=>{const ot=X[s()]?new Date(X[s()]):new Date(0);return(tt[s()]?new Date(tt[s()]):new Date(0)).getTime()-ot.getTime()})});Be(()=>{if(n&&typeof window<"u"){const tt=n.getBoundingClientRect(),ot=window.scrollY||window.pageYOffset;d=tt.top+ot,K(O,tt.height,!0),K(L,tt.width,!0),K(W,tt.left,!0)}typeof window<"u"&&(window.addEventListener("scroll",yt,{passive:!0}),yt());const T=()=>{if(n&&typeof window<"u"){if(!t(o)){const tt=n.getBoundingClientRect(),ot=window.scrollY||window.pageYOffset;(d===0||Math.abs(d-(tt.top+ot))>10)&&(d=tt.top+ot,K(L,tt.width,!0),K(W,tt.left,!0),K(o,ot>=d),t(o)&&K(O,tt.height,!0))}yt()}};requestAnimationFrame(()=>{requestAnimationFrame(T)});const X=()=>{if(n&&typeof window<"u"){if(!t(o)){const tt=n.getBoundingClientRect(),ot=window.scrollY||window.pageYOffset;d===0&&(d=tt.top+ot),K(L,tt.width,!0),K(W,tt.left,!0)}if(t(o)){const tt=n.getBoundingClientRect();K(O,tt.height,!0)}yt()}};return typeof window<"u"&&window.addEventListener("resize",X,{passive:!0}),()=>{typeof window<"u"&&(window.removeEventListener("scroll",yt),window.removeEventListener("resize",X))}});var xt=ta(),Mt=h(xt);let Ot;var Bt=h(Mt);pr(Bt,{get data(){return t(j)},get filterConfig(){return t(gt)},get filterOptions(){return A()},get filterValues(){return t(F)},get searchQuery(){return t(Z)},get filteredRowCount(){return t(kt)},get categoryDefinitions(){return a()},onFilterChange:at,get onDownloadCSV(){return w()},get exporting(){return t(S)},get exportProgress(){return t(J)},get isSticky(){return t(o)}}),u(Mt),Fe(Mt,T=>n=T,()=>n);var It=D(Mt,2);{var Xt=T=>{var X=Br();vt(()=>Te(X,`height: ${t(O)??""}px;`)),b(T,X)};st(It,T=>{t(o)&&T(Xt)})}var Nt=D(It,2);{var Zt=T=>{var X=Pr(),tt=h(X);qr(tt,{get data(){return t(ut)},get dateField(){return s()},orgField:"org",get searchQuery(){return t(rt)},get stats(){return R()}}),u(X),b(T,X)};st(Nt,T=>{t($)||T(Zt)})}var pe=D(Nt,2);{var re=T=>{var X=Zr(),tt=ft(X);{var ot=Et=>{var Qt=Yr(),pt=h(Qt);{var _t=ct=>{var dt=Nr(),qt=D(ft(dt),2),Tt=h(qt);u(qt),vt(()=>wt(Tt,`"${t(H)??""}"`)),b(ct,dt)},it=ct=>{var dt=Ct(),qt=ft(dt);{var Tt=Lt=>{var Kt=Vr(),de=D(ft(Kt),2);Pt(de,17,()=>t(et),Ht,(jt,Gt,me)=>{var ke=zr(),Ae=ft(ke);{var ue=ae=>{var be=Qr();b(ae,be)};st(Ae,ae=>{me>0&&ae(ue)})}var te=D(Ae,2),_e=h(te);u(te),vt(()=>wt(_e,`"${t(Gt)??""}"`)),b(jt,ke)}),b(Lt,Kt)},Ut=Lt=>{var Kt=Kr(),de=D(ft(Kt),2),jt=h(de);u(de),vt(Gt=>wt(jt,`"${Gt??""}"`),[()=>t(rt).trim()]),b(Lt,Kt)};st(qt,Lt=>{t(et).length>1?Lt(Tt):Lt(Ut,!1)},!0)}b(ct,dt)};st(pt,ct=>{t(P)&&t(H)?ct(_t):ct(it,!1)})}var ht=D(pt,2),bt=h(ht);u(ht),u(Qt),vt(()=>wt(bt,`— ${t(kt)??""} result${t(kt)!==1?"s":""}`)),b(Et,Qt)};st(tt,Et=>{!t($)&&t(rt)&&t(rt).trim()&&Et(ot)})}var Dt=D(tt,2);{var St=Et=>{{let Qt=E(()=>!!(t(rt)&&t(rt).trim())),pt=E(()=>t(N)?"Exact phrase searches take longer. Thanks for your patience.":"");Rr(Et,{get loading(){return t($)},get progress(){return t(mt)},get showProgress(){return t(Qt)},get note(){return t(pt)}})}},Vt=Et=>{var Qt=Ct(),pt=ft(Qt);{var _t=ht=>{var bt=Hr();b(ht,bt)},it=ht=>{var bt=Xr();let ct;var dt=h(bt);{var qt=jt=>{const Gt=E(()=>Object.entries(t(Rt)));var me=Ct(),ke=ft(me);Pt(ke,17,()=>t(Gt),Ht,(Ae,ue)=>{var te=E(()=>In(t(ue),2));let _e=()=>t(te)[0],ae=()=>t(te)[1];const be=E(()=>ae()[0]),ee=E(()=>{var ie;return(ie=t(be))!=null&&ie.date?new Date(t(be).date):null}),Yt=E(()=>t(ee)&&!isNaN(t(ee).getTime())?t(ee).toLocaleString("default",{month:"long",day:"numeric",year:"numeric"}):_e());var Jt=Ur(),se=h(Jt),ne=h(se),Wt=h(ne),fe=h(Wt,!0);u(Wt);var oe=D(Wt,2),he=h(oe,!0);u(oe),u(ne),u(se);var ve=D(se,4),ge=h(ve);{var we=ie=>{var Ie=Ct(),Ge=ft(Ie);Pt(Ge,17,ae,Ht,(Je,Ce,Qe)=>{const Xe=E(l),je=E(()=>t(Ce).date?new Date(t(Ce).date):null),Ze=E(()=>t(je)&&!isNaN(t(je).getTime())?t(je).toLocaleString("default",{month:"long",day:"numeric",year:"numeric"}):"");var ze=Ct(),Ve=ft(ze);en(Ve,()=>t(Xe),($e,vn)=>{vn($e,{get item(){return t(Ce)},get dateKey(){return t(Ze)},index:Qe,get searchQuery(){return t(Z)},get filterValues(){return t(F)}})}),b(Je,ze)}),b(ie,Ie)},We=ie=>{var Ie=Ct(),Ge=ft(Ie);{var Je=Ce=>{var Qe=Ct(),Xe=ft(Qe);Pt(Xe,17,ae,Ht,(je,Ze,ze)=>{var Ve=Ct(),$e=ft(Ve);tn($e,f,()=>({item:t(Ze),index:ze,searchQuery:t(Z),filterValues:t(F)})),b(je,Ve)}),b(Ce,Qe)};st(Ge,Ce=>{f()&&Ce(Je)},!0)}b(ie,Ie)};st(ge,ie=>{l()?ie(we):ie(We,!1)})}u(ve),u(Jt),vt((ie,Ie)=>{wt(fe,ie),wt(he,Ie)},[()=>t(Yt).split(",").slice(0,1).join(",").trim(),()=>t(Yt).split(",").slice(1).join(",").trim()]),b(Ae,Jt)}),b(jt,me)},Tt=jt=>{var Gt=Ct(),me=ft(Gt);{var ke=ue=>{var te=Wr(),_e=D(h(te)),ae=h(_e);{var be=Yt=>{var Jt=Ct(),se=ft(Jt);Pt(se,17,()=>t(At),Ht,(ne,Wt,fe)=>{const oe=E(l);var he=Ct(),ve=ft(he);en(ve,()=>t(oe),(ge,we)=>{we(ge,{get item(){return t(Wt)},index:fe,get searchQuery(){return t(rt)},get filterValues(){return t(F)},get dateField(){return s()}})}),b(ne,he)}),b(Yt,Jt)},ee=Yt=>{var Jt=Ct(),se=ft(Jt);{var ne=Wt=>{var fe=Ct(),oe=ft(fe);Pt(oe,17,()=>t(At),Ht,(he,ve,ge)=>{var we=Ct(),We=ft(we);tn(We,f,()=>({item:t(ve),index:ge,searchQuery:t(rt),filterValues:t(F)})),b(he,we)}),b(Wt,fe)};st(se,Wt=>{f()&&Wt(ne)},!0)}b(Yt,Jt)};st(ae,Yt=>{l()?Yt(be):Yt(ee,!1)})}u(_e),u(te),b(ue,te)},Ae=ue=>{var te=Ct(),_e=ft(te);{var ae=ee=>{var Yt=Ct(),Jt=ft(Yt);Pt(Jt,17,()=>t(At),Ht,(se,ne,Wt)=>{const fe=E(l);var oe=Ct(),he=ft(oe);en(he,()=>t(fe),(ve,ge)=>{ge(ve,{get item(){return t(ne)},index:Wt,get searchQuery(){return t(rt)},get filterValues(){return t(F)}})}),b(se,oe)}),b(ee,Yt)},be=ee=>{var Yt=Ct(),Jt=ft(Yt);{var se=ne=>{var Wt=Ct(),fe=ft(Wt);Pt(fe,17,()=>t(At),Ht,(oe,he,ve)=>{var ge=Ct(),we=ft(ge);tn(we,f,()=>({item:t(he),index:ve,searchQuery:t(rt),filterValues:t(F)})),b(oe,ge)}),b(ne,Wt)};st(Jt,ne=>{f()&&ne(se)},!0)}b(ee,Yt)};st(_e,ee=>{l()?ee(ae):ee(be,!1)})}b(ue,te)};st(me,ue=>{c()==="table"?ue(ke):ue(Ae,!1)})}b(jt,Gt)};st(dt,jt=>{v()?jt(qt):jt(Tt,!1)})}var Ut=D(dt,2);{var Lt=jt=>{var Gt=Gr();b(jt,Gt)};st(Ut,jt=>{t(B)&&jt(Lt)})}var Kt=D(Ut,2);{var de=jt=>{var Gt=Jr();Fe(Gt,me=>K(G,me),()=>t(G)),b(jt,Gt)};st(Kt,jt=>{_()&&jt(de)})}u(bt),vt(jt=>ct=xe(bt,1,`data-container data-${c()??""}`,"svelte-17yoswn",ct,jt),[()=>({timeline:v()})]),b(ht,bt)};st(pt,ht=>{t(Y)&&t(kt)===0?ht(_t):ht(it,!1)},!0)}b(Et,Qt)};st(Dt,Et=>{t($)?Et(St):Et(Vt,!1)})}b(T,X)},$t=T=>{var X=$r();b(T,X)};st(pe,T=>{t(Y)?T(re):T($t,!1)})}u(xt),vt(T=>{Ot=xe(Mt,1,"filter-bar-wrapper svelte-17yoswn",null,Ot,T),Te(Mt,t(o)&&t(L)>0?`width: ${t(L)}px; left: ${t(W)}px;`:"")},[()=>({sticky:t(o)})]),b(r,xt),Me()}function Ye(r,e){Se(e,!0);let i=Q(e,"text",3,""),a=Q(e,"searchQuery",3,""),p=Q(e,"searchTerms",19,()=>[]);const A=E(()=>{const c=Array.isArray(p())&&p().length?p().filter(Boolean).join(" "):"",v=[a(),c].filter(Boolean).join(" ").trim();return jr(i(),v)});var s=Ct(),l=ft(s);Rn(l,()=>t(A)),b(r,s),Me()}var na=U("<span><!></span>"),ra=U('<div class="org-tags svelte-101yu1j"></div>'),aa=U('<a target="_blank" rel="noopener noreferrer" class="title-link svelte-101yu1j"><!></a>'),sa=U('<div class="content-title svelte-101yu1j"><!></div>'),oa=U('<div class="description-text svelte-101yu1j"><!></div>'),ia=U('<tr class="table-row svelte-101yu1j"><td class="table-cell table-date svelte-101yu1j"> </td><td class="table-cell table-org svelte-101yu1j"><!></td><td class="table-cell table-content svelte-101yu1j"><!> <!></td></tr>');function la(r,e){Se(e,!0);let i=Q(e,"searchQuery",3,""),a=Q(e,"filterValues",19,()=>({})),p=Q(e,"dateField",3,"date");function A(n){if(!n)return"";try{const o=new Date(n);return isNaN(o.getTime())?n:o.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"})}catch{return n}}const s=E(()=>{var n,o;return Array.isArray((n=e.item)==null?void 0:n.org)?e.item.org:((o=e.item)!=null&&o.org?[e.item.org]:[]).filter(Boolean)}),l=E(()=>a()["filter-School"]||[]),c=E(()=>new Set(t(l)));function v(n){return t(l).length>0&&t(c).has(n)}const _=["#98d7cd","#7bccbe","#5dc0b0","#bbdefb","#9ed1fa","#77bef8","#a89dfb","#9789fa","#8575fa"];function q(n){if(!n)return"#f0f0f0";let o=0;for(let O=0;O<n.length;O++)o=n.charCodeAt(O)+((o<<5)-o);const d=Math.abs(o)%_.length;return _[d]}function z(n){if(!n)return"#333";const d=q(n).replace("#",""),O=Math.max(0,parseInt(d.substring(0,2),16)-80),L=Math.max(0,parseInt(d.substring(2,4),16)-80),W=Math.max(0,parseInt(d.substring(4,6),16)-80);return`#${O.toString(16).padStart(2,"0")}${L.toString(16).padStart(2,"0")}${W.toString(16).padStart(2,"0")}`}const m=E(()=>{var n,o;return((n=e.item)==null?void 0:n.description)||((o=e.item)==null?void 0:o.content)||""}),R=E(()=>Lr(t(m),i()));var y=ia(),M=h(y),I=h(M,!0);u(M);var x=D(M),w=h(x);{var f=n=>{var o=ra();Pt(o,21,()=>t(s),Ht,(d,O)=>{var L=na();let W;var V=h(L);Ye(V,{get text(){return t(O)},get searchQuery(){return i()}}),u(L),vt((G,lt,gt)=>{W=xe(L,1,"org-tag svelte-101yu1j",null,W,G),Te(L,`background-color: ${lt??""}; color: ${gt??""};`)},[()=>({selected:v(t(O))}),()=>v(t(O))?"#fff3cd":q(t(O)),()=>z(t(O))]),b(d,L)}),u(o),b(n,o)};st(w,n=>{t(s).length>0&&n(f)})}u(x);var F=D(x),Z=h(F);{var B=n=>{var o=sa(),d=h(o);{var O=W=>{var V=aa(),G=h(V);Ye(G,{get text(){return e.item.title},get searchQuery(){return i()}}),u(V),vt(()=>k(V,"href",e.item.url)),b(W,V)},L=W=>{Ye(W,{get text(){return e.item.title},get searchQuery(){return i()}})};st(d,W=>{e.item.url?W(O):W(L,!1)})}u(o),b(n,o)};st(Z,n=>{var o;(o=e.item)!=null&&o.title&&n(B)})}var rt=D(Z,2);{var Y=n=>{var o=oa(),d=h(o);Ye(d,{get text(){return t(R)},get searchQuery(){return i()}}),u(o),b(n,o)};st(rt,n=>{t(R)&&n(Y)})}u(F),u(y),vt(n=>wt(I,n),[()=>A(e.item[p()])]),b(r,y),Me()}const ca=r=>{var e;return r&&(r.id||((e=r._id)==null?void 0:e.$oid)||r._id||r.document_id)||null},da=({fetcher:r=fetch,urls:e})=>{const i=new Map,a=new Map;let p=null,A=null;const s=async(m,R={})=>{const{signal:y=null,emptyOn404:M=!1,returnNullOn404:I=!1,emptyOn403:x=!1,returnNullOn403:w=!1}=R,f=await r(m,y?{signal:y,cache:"no-cache"}:{cache:"no-cache"});if((f.status===404||f.status===403)&&(M||I||x||w))return f.status===403?w?null:[]:I?null:[];if(!f.ok)throw new Error(`Failed to load ${m}: ${f.status}`);const F=await f.text();return nn(F)},l=async(m,R={})=>{const{signal:y=null,onProgress:M=null,emptyOn404:I=!1,returnNullOn404:x=!1,emptyOn403:w=!1,returnNullOn403:f=!1}=R,F=await r(m,y?{signal:y,cache:"no-cache"}:{cache:"no-cache"});if((F.status===404||F.status===403)&&(I||x||w||f))return F.status===403?f?null:[]:x?null:[];if(!F.ok)throw new Error(`Failed to load ${m}: ${F.status}`);if(!M||!F.body){const d=await F.text();return nn(d)}const Z=F.body.getReader(),B=new TextDecoder,rt=F.headers.get("content-length"),Y=rt?Number(rt):0;let n=0,o="";for(;;){const{done:d,value:O}=await Z.read();if(d)break;n+=(O==null?void 0:O.length)||0,o+=B.decode(O,{stream:!0}),Y>0&&M(n,Y)}return o+=B.decode(),Y>0&&M(Y||n,Y),nn(o)},c=async(m,R={})=>{if(!m)return null;if(i.has(m))return i.get(m);try{const y=encodeURIComponent(m),{emptyOn404:M=!0,returnNullOn404:I=!1,emptyOn403:x=M,returnNullOn403:w=I,onProgress:f=null,...F}=R,B=await(f?l:s)(e.searchTerm(y),{...F,onProgress:f,emptyOn404:M,returnNullOn404:I,emptyOn403:x,returnNullOn403:w});return Array.isArray(B)?(i.set(m,B),B):[]}catch{return[]}},v=async(m={})=>{if(p)return p;const{onProgress:R=null,...y}=m,I=await(R?l:s)(e.fullData,{...y,onProgress:R});return p=I,I},_=async(m={})=>{if(A)return A;const R=await v(m),y=new Map;return Array.isArray(R)&&R.forEach(M=>{const I=ca(M);I&&y.set(I,M)}),A=y,A},q=async(m,R={})=>{if(a.has(m))return a.get(m);const y=await s(e.article(m),R);return a.set(m,y),y};return{fetchJson:s,fetchJsonWithProgress:l,ensureTokenLoaded:c,getFullDataset:v,ensureFullDatasetMap:_,getArticleById:q,getArticleForSearch:async(m,R)=>{if(a.has(m))return a.get(m);if(R&&R.has(m)){const y=R.get(m);return a.set(m,y),y}return q(m)}}},ua=r=>Array.from(new Set(r)).sort((e,i)=>Number(i)-Number(e)),fa=({fetchJson:r,urls:e,minYear:i=2025,state:a})=>{const p=async()=>{const c=await r(e.monthManifest),v=Object.keys(c||{}).filter(_=>/^\d{4}$/.test(_)&&Number(_)>=i);if(v.length===0)throw new Error("Month index manifest is empty");return{years:ua(v),manifest:c}};return{getMonthIndexYears:p,loadMonthManifestOptions:async()=>{const{manifest:c}=await p();if(a.manifestMonthCounts=new Map,c){for(const[_,q]of Object.entries(c))if(!(!/^\d{4}$/.test(_)||Number(_)<i)&&q&&typeof q=="object")for(const[z,m]of Object.entries(q)){const R=Number((z||"").split("-")[0]);Number.isFinite(R)&&R>=i&&a.manifestMonthCounts.set(z,m)}}const v=Array.from(a.manifestMonthCounts.keys());a.months=v.filter(_=>{if(_==="_no_date")return!1;const q=Number((_||"").split("-")[0]);return Number.isFinite(q)&&q>=i}).sort().reverse(),a.monthFiltersReady=!0},loadInstitutionManifestOptions:async()=>{const c=await r(e.institutionManifest),v=Object.keys(c||{}).filter(_=>c[_]&&typeof c[_]=="object");if(v.length===0)throw new Error("Institution manifest is empty");a.institutionManifest=c,a.institutionShards=v,a.institutions=v.flatMap(_=>Object.keys(c[_]||{})).filter(Boolean).sort((_,q)=>_.localeCompare(q))},getInstitutionShards:async()=>{if(Array.isArray(a.institutionShards)&&a.institutionShards.length>0)return a.institutionShards;const c=await r(e.institutionManifest);a.institutionManifest=c;const v=Object.keys(c||{}).filter(_=>c[_]&&typeof c[_]=="object");if(v.length===0)throw new Error("Institution manifest is empty");return a.institutionShards=v,a.institutionShards}}},ha=({fetchJson:r,urls:e,minYear:i=2025,state:a,getMonthIndexYears:p,getInstitutionShards:A})=>{const s=M=>{let I=!1;if(M&&typeof M=="object")for(const[x,w]of Object.entries(M))Array.isArray(w)&&(a.monthIndex[x]?a.monthIndex[x]=[...a.monthIndex[x],...w]:a.monthIndex[x]=w,I=!0);return I},l=()=>{const M=Array.from(a.manifestMonthCounts.keys()),I=Array.from(new Set([...Object.keys(a.monthIndex),...M]));a.months=I.filter(x=>{if(x==="_no_date")return!1;const w=Number((x||"").split("-")[0]);return Number.isFinite(w)&&w>=i}).sort().reverse(),a.globalIds=[];for(const x of a.months){const w=a.monthIndex[x];Array.isArray(w)&&a.globalIds.push(...w)}a.noDateIds=[]},c=M=>r(e.monthIndex(M)),v=async M=>{if(!Array.isArray(M)||M.length===0)return;const I=new Set(M.map(w=>String(w||"").split("-")[0]).filter(w=>/^\d{4}$/.test(w)));let x=!1;for(const w of I){if(a.loadedMonthFiles.has(w))continue;const f=await c(w);a.loadedMonthFiles.add(w),x=s(f)||x}x&&l()},_=async()=>{const M=Array.isArray(a.months)&&a.months.length>0?a.months:[],I=new Set((M.length>0?M:[]).map(w=>String(w||"").split("-")[0]).filter(w=>/^\d{4}$/.test(w)));if(I.size===0){const{years:w}=await p();w.forEach(f=>I.add(f))}let x=!1;for(const w of I){if(a.loadedMonthFiles.has(w))continue;const f=await c(w);a.loadedMonthFiles.add(w),x=s(f)||x}x&&l()},q=async()=>{if(a.selectedMonths.length>0){await v(a.selectedMonths);return}await _()},z=M=>r(e.institutionShard(M)),m=async M=>{var w;if(!Array.isArray(M)||M.length===0)return;(!Array.isArray(a.institutionShards)||a.institutionShards.length===0)&&await A();const I=new Set;for(const f of M){if(!f||typeof f!="string")continue;const F=f.trim().charAt(0).toLowerCase();F&&((w=a.institutionShards)!=null&&w.includes(F))&&I.add(F)}if(I.size===0)return;const x=await Promise.allSettled([...I].map(f=>z(f).then(F=>({shard:f,data:F}))));for(const f of x){if(f.status!=="fulfilled")continue;const{shard:F,data:Z}=f.value;a.loadedInstitutionShards.has(F)||Z&&typeof Z=="object"&&(Object.assign(a.institutionIndex,Z),a.loadedInstitutionShards.add(F))}},R=async()=>{const I=(await A()).filter(w=>!a.loadedInstitutionShards.has(w));if(I.length===0)return;const x=await Promise.allSettled(I.map(w=>z(w).then(f=>({shard:w,data:f}))));for(const w of x){if(w.status!=="fulfilled")continue;const{shard:f,data:F}=w.value;a.loadedInstitutionShards.has(f)||F&&typeof F=="object"&&(Object.assign(a.institutionIndex,F),a.loadedInstitutionShards.add(f))}};return{mergeMonthData:s,finalizeMonthIndex:l,loadMonthIndexFile:c,ensureMonthIndexesForSelection:v,ensureAllMonthIndexes:_,ensureMonthIndexesForStats:q,loadInstitutionShard:z,ensureInstitutionShardsForSelection:m,ensureAllInstitutionShards:R,ensureInstitutionIndexesForStats:async()=>{if(a.selectedInstitutions.length>0){await m(a.selectedInstitutions);return}await R()}}},va=r=>r.join("_"),ga=(r,e)=>{const i=new Set,a=[];for(const p of r){const A=e.get(p);if(Array.isArray(A))for(const s of A)i.has(s)||(i.add(s),a.push(s))}return a},pa=({ensureTokenLoaded:r,ensureFullDatasetMap:e,getArticleForSearch:i,getBaseIdsFromFilters:a})=>{let p=0,A=null;const s=()=>(p+=1,A&&A.abort(),A=new AbortController,{runId:p,signal:A.signal}),l=v=>v===p;return{applyFiltersAndSearch:async(v,_={})=>{const{onSearchProgress:q=null,onExactMatchActive:z=null}=_,{runId:m,signal:R}=s(),y=await a(),M=y.length>0,I=M?new Set(y):null,x=sn(v),w=x?Ee(x):[],f=x&&w.length>1;if(z&&z(!!f),f){const V=w.length?va(w):null;if(V){const nt=await r(V,{signal:R,returnNullOn404:!0,returnNullOn403:!0,onProgress:q?(yt,ut)=>{ut>0&&q(Math.min(1,yt/ut))}:null});if(!l(m))return null;if(Array.isArray(nt)&&nt.length>0){const yt=new Set(nt),ut=M?y.filter(kt=>yt.has(kt)):nt;return{activeIds:ut,expectedTotalCount:ut.length}}}const lt=await e({signal:R,onProgress:q?(at,nt)=>{nt>0&&q(Math.min(1,at/nt))}:null});if(!l(m))return null;const gt=Ue(x,"i"),j=He(x,"i"),H=gt||j;if(!H)return{activeIds:[],expectedTotalCount:0};const P=[],et=M?y:Array.from(lt.keys());for(const at of et){if(!l(m))return null;const nt=await i(at,lt);[nt==null?void 0:nt.title,nt==null?void 0:nt.org,nt==null?void 0:nt.content].some(kt=>typeof kt!="string"?!1:(H.lastIndex=0,H.test(kt)))&&P.push(at)}return l(m)?{activeIds:P,expectedTotalCount:P.length}:null}const F=Ee(v);if(F.length===0)return{activeIds:y,expectedTotalCount:y.length};const Z=Array.from(new Set(F)),B=new Map,rt=Z.length;let Y=0;const n=V=>{if(!q)return;const G=Math.min(Math.max(V||0,0),1);q(Math.min(1,(Y+G)/Math.max(rt,1)))};for(const V of Z){if(!l(m))return null;let G,lt=0;G=await r(V,{signal:R,onProgress:(gt,j)=>{l(m)&&j>0&&(lt=gt/j,n(lt))}}),Y+=1,n(0),Array.isArray(G)&&G.length>0&&B.set(V,G)}if(B.size===0)return{activeIds:[],expectedTotalCount:0};const o=new Map;for(const V of F){const G=B.get(V);if(Array.isArray(G))for(const lt of G){if(I&&!I.has(lt))continue;const gt=o.get(lt)||0;o.set(lt,gt+1)}}if(o.size===0)return{activeIds:[],expectedTotalCount:0};const d=M?y:ga(F,B),O=new Map;for(const V of d){const G=o.get(V);G&&(O.has(G)||O.set(G,[]),O.get(G).push(V))}const L=[...O.keys()].sort((V,G)=>G-V),W=[];for(const V of L)W.push(...O.get(V));return{activeIds:W,expectedTotalCount:W.length}}}},ya=({state:r,ensureMonthIndexesForStats:e,ensureInstitutionIndexesForStats:i,getActiveIds:a,getTotalCount:p})=>{const A=async({includeEmpty:c=!1}={})=>{const v=a();if(!v||v.length===0)return{};await e();const _=new Set(v),q={};for(const z of r.months){if(z==="_no_date")continue;const m=r.monthIndex[z];if(!Array.isArray(m)||m.length===0){c&&(q[z]=0);continue}let R=0;for(const y of m)_.has(y)&&(R+=1);(R>0||c)&&(q[z]=R)}return q},s=async({includeEmpty:c=!1}={})=>{const v=a();if(!v||v.length===0)return{};await i();const _=new Set(v),q={};for(const[z,m]of Object.entries(r.institutionIndex)){if(!Array.isArray(m)||m.length===0){c&&(q[z]=0);continue}let R=0;for(const y of m)_.has(y)&&(R+=1);(R>0||c)&&(q[z]=R)}return q};return{getActiveMonthlyCounts:A,getActiveInstitutionCounts:s,getActiveStats:async({topN:c=5}={})=>{const[v,_]=await Promise.all([A(),s()]),q=Object.entries(_).filter(([,m])=>m>0).sort((m,R)=>R[1]-m[1]).slice(0,c).map(([m,R])=>({org:m,count:R})),z=Object.values(_).filter(m=>m>0).length;return{monthlyCounts:v,institutionCounts:_,topInstitutions:q,totalRecords:p(),totalSchools:z}}}},ma=({urls:r={},fetcher:e=fetch,minYear:i=2025,onSearchStateChange:a=null,onExportStateChange:p=null}={})=>{const A={...Le,...r,monthIndex:r.monthIndex||Le.monthIndex,institutionShard:r.institutionShard||Le.institutionShard,article:r.article||Le.article,searchTerm:r.searchTerm||Le.searchTerm},s={monthIndex:{},institutionIndex:{},institutionManifest:null,institutionShards:null,manifestMonthCounts:new Map,months:[],institutions:[],globalIds:[],noDateIds:[],loadedMonthFiles:new Set,loadedInstitutionShards:new Set,monthFiltersReady:!1,selectedMonths:[],selectedInstitutions:[]};let l="",c=[],v=0,_=0;const q=1e3;let z={loading:!1,progress:0,exactMatchActive:!1},m={exporting:!1,progress:0};const R=()=>{typeof a=="function"&&a({...z})},y=g=>{z={...z,...g},R()},M=()=>{typeof p=="function"&&p({...m})},I=g=>{m={...m,...g},M()},{fetchJson:x,ensureTokenLoaded:w,ensureFullDatasetMap:f,getFullDataset:F,getArticleById:Z,getArticleForSearch:B}=da({fetcher:e,urls:A}),rt=fa({fetchJson:x,urls:A,minYear:i,state:s}),Y=ha({fetchJson:x,urls:A,minYear:i,state:s,getMonthIndexYears:rt.getMonthIndexYears,getInstitutionShards:rt.getInstitutionShards}),o=pa({ensureTokenLoaded:w,ensureFullDatasetMap:f,getArticleForSearch:B,getBaseIdsFromFilters:async()=>{let g=[];if(s.selectedMonths.length>0){await Y.ensureMonthIndexesForSelection(s.selectedMonths);const S=new Set(s.selectedMonths),J=s.months.filter($=>S.has($));for(const $ of J){const mt=s.monthIndex[$];Array.isArray(mt)&&g.push(...mt)}}if(s.selectedInstitutions.length===0)return g;await Y.ensureInstitutionShardsForSelection(s.selectedInstitutions);const C=new Set,N=[];for(const S of s.selectedInstitutions){const J=s.institutionIndex[S];if(Array.isArray(J))for(const $ of J)C.has($)||(C.add($),N.push($))}return N.length===0?[]:g.length===0?N:g.filter(S=>C.has(S))}}),d=ya({state:s,ensureMonthIndexesForStats:Y.ensureMonthIndexesForStats,ensureInstitutionIndexesForStats:Y.ensureInstitutionIndexesForStats,getActiveIds:()=>c,getTotalCount:()=>v||c.length}),O=async()=>(await rt.loadMonthManifestOptions(),await rt.loadInstitutionManifestOptions(),c=[],v=0,_=0,{months:s.months,institutions:s.institutions}),L=({months:g=null,institutions:C=null}={})=>{Array.isArray(g)&&(s.selectedMonths=g),Array.isArray(C)&&(s.selectedInstitutions=C)},W=g=>{l=g||""},V=async()=>{const g=!!(l||"").trim();y({loading:g,progress:0,exactMatchActive:!1});const C=await o.applyFiltersAndSearch(l,{onSearchProgress:N=>{y({progress:N})},onExactMatchActive:N=>{y({exactMatchActive:N})}});C&&(c=C.activeIds,v=C.expectedTotalCount,_=0,y({loading:!1}))},G=()=>{_=0},lt=async(g=10)=>{const C=c||[],N=_,S=Math.min(N+g,C.length),J=C.slice(N,S),$=await Promise.all(J.map(mt=>Z(mt)));return _=S,{items:$,hasMore:_<C.length,total:v||C.length}},gt=async()=>({months:s.months,institutions:s.institutions}),j=()=>v||c.length,H=()=>({...z}),P=()=>({...m}),et=()=>s.selectedMonths.length===0&&s.selectedInstitutions.length===0&&!String(l||"").trim(),at=g=>g.map(C=>{if(!C||typeof C!="object")return C;const{llm_response:N,scraper:S,...J}=C;return J}),nt=async(g,C="export.csv")=>{if(!g||g.length===0)throw new Error("No data to export");const N=new Set;g.forEach(xt=>{Object.keys(xt||{}).forEach(Mt=>N.add(Mt))});const S=Array.from(N),J=xt=>xt==null?"":Array.isArray(xt)?xt.join("; "):typeof xt=="object"?JSON.stringify(xt):String(xt),$=[];$.push(S.map(xt=>`"${String(xt).replace(/\"/g,'""')}"`).join(",")),g.forEach(xt=>{const Mt=S.map(Ot=>`"${J(xt==null?void 0:xt[Ot]).replace(/\"/g,'""')}"`);$.push(Mt.join(","))});const mt=new Blob([$.join(`
`)],{type:"text/csv;charset=utf-8;"}),Rt=URL.createObjectURL(mt),At=document.createElement("a");At.href=Rt,At.download=C,document.body.appendChild(At),At.click(),document.body.removeChild(At),URL.revokeObjectURL(Rt)},yt=(g,C=40)=>{if(!g)return"";const N=String(g).toLowerCase().replace(/\"/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return N?N.length>C?N.slice(0,C):N:""},ut=()=>{const C=["announcements-export",new Date().toISOString().slice(0,10)],N=String(l||"").trim();if(N){const J=N.replace(/^\"(.*)\"$/,"$1"),$=yt(J,50);$&&C.push(`search-${$}`)}if(Array.isArray(s.selectedMonths)&&s.selectedMonths.length>0&&(s.selectedMonths.length===1?C.push(`month-${yt(s.selectedMonths[0],20)}`):C.push(`months-${s.selectedMonths.length}`)),Array.isArray(s.selectedInstitutions)&&s.selectedInstitutions.length>0)if(s.selectedInstitutions.length===1){const J=yt(s.selectedInstitutions[0],40);J&&C.push(`inst-${J}`)}else C.push(`inst-${s.selectedInstitutions.length}`);let S=C.filter(Boolean).join("-");return S.length>120&&(S=S.slice(0,120)),`${S}.csv`},kt=async()=>{if(!c||c.length===0)throw new Error("No data to export");I({exporting:!0,progress:0});try{const g=et()||c.length>q;let C;if(g){const S=(J,$)=>{$>0&&I({progress:Math.min(1,J/$)})};if(et())C=await F({onProgress:S});else{const J=await f({onProgress:S});C=c.map($=>J.get($)).filter(Boolean)}}else{const S=c.length;let J=0;const $=async mt=>{const Rt=await Z(mt);return J+=1,I({progress:Math.min(1,J/Math.max(S,1))}),Rt};C=await Promise.all(c.map(mt=>$(mt)))}const N=at(C);I({progress:1}),await nt(N,ut())}finally{I({exporting:!1,progress:0})}};return{init:O,setFilters:L,setSearch:W,applyFiltersAndSearch:V,resetResults:G,loadMore:lt,getFilterOptions:gt,getTotalCount:j,getActiveMonthlyCounts:d.getActiveMonthlyCounts,getActiveInstitutionCounts:d.getActiveInstitutionCounts,getActiveStats:d.getActiveStats,getSearchState:H,getExportState:P,exportResults:kt}};var _a=U("<!> <!>",1),ba=U("<!> <!> <!>",1);function Ta(r,e){var gt;Se(e,!1);let i=Q(e,"data",8);const a=Dn((gt=i())==null?void 0:gt.metadata,Ft.lastUpdatedField),p=Ft.categoryDefinitions||{},A=10;let s,l=ye([]),c=ye(!1),v=ye(0),_=ye({}),q=ye(null),z=ye({loading:!1,progress:0,exactMatchActive:!1}),m=ye({exporting:!1,progress:0}),R=ye(!1),y=ye(""),M="",I=0,x=!1,w=new Map,f=null;const F=j=>{const H=(j==null?void 0:j.$date)||j;if(!H||typeof H!="string")return null;const P=H.match(/^(\d{4}-\d{2}-\d{2})/);return P?P[1]:H},Z=j=>{var at;if(!j)return j;const H=j.id||((at=j._id)==null?void 0:at.$oid)||j._id||j.document_id||null;if(H&&w.has(H))return w.get(H);const P=Array.isArray(j.org)?j.org:typeof j.org=="string"?j.org.split(",").map(nt=>nt.trim()).filter(Boolean):[],et={...j,_id:H??j._id,date:F(j.date),last_updated:F(j.last_updated_at||j.last_updated),org:P,description:j.description||j.content||""};return H&&w.set(H,et),et},B=(j,H)=>{const P=(Ft.filterConfig||[]).find(at=>at.dataKey===j),et=(P==null?void 0:P.column)||(P==null?void 0:P.label)||H;return et?`filter-${et}`:null},rt=B("month","Month"),Y=B("org","School");async function n(){try{s=ma({onSearchStateChange:H=>{K(z,H)},onExportStateChange:H=>{K(m,H)}}),await s.init();const j=await s.getFilterOptions();K(_,{month:j.months||[],org:j.institutions||[]}),K(z,s.getSearchState()),K(m,s.getExportState())}catch(j){console.error("Failed to initialize database engine",j)}}async function o(){const j=++I;if(K(y,M),await s.applyFiltersAndSearch(),j===I){K(R,!0);try{const[H,P]=await Promise.all([s.loadMore(A),s.getActiveStats()]);if(j!==I)return;K(l,H.items.map(Z)),K(c,H.hasMore),K(v,H.total),K(q,P)}finally{j===I&&K(R,!1)}}}async function d(){if(!s||x||!t(c))return;x=!0;const j=I;try{const H=await s.loadMore(A);if(j!==I)return;K(l,[...t(l),...H.items.map(Z)]),K(c,H.hasMore),K(v,H.total)}finally{x=!1}}async function O(){if(s)try{await s.exportResults()}catch(j){console.error("Error exporting data",j),alert((j==null?void 0:j.message)||"Error exporting data")}}function L({filterValues:j,searchQuery:H}){if(!s)return;const P=rt?j[rt]||[]:[],et=Y?j[Y]||[]:[];s.setFilters({months:P,institutions:et}),s.setSearch(H),M=H,f&&clearTimeout(f),f=setTimeout(()=>{o()},500)}Be(async()=>{await n(),await o()}),Be(()=>()=>{f&&clearTimeout(f)}),Cn();var W=ba(),V=ft(W);An(V,{});var G=D(V,2);qn(G,{children:(j,H)=>{var P=_a(),et=ft(P);Fn(et,{get hed(){return ce(Ft),le(()=>Ft.headline)},subhed:"Browse all announcements with filters. Use the filters to narrow down by school, date range, or search terms.",get brand(){return ce(Ft),le(()=>Ft.brand)},get date(){return a},get dateLabel(){return ce(Ft),le(()=>Ft.dateLabel)},get byline(){return ce(Ft),le(()=>Ft.byline)},get byline_url(){return ce(Ft),le(()=>Ft.bylineUrl)},get maintainedBy(){return ce(Ft),le(()=>Ft.maintainedBy)},get designDevelopment(){return ce(Ft),le(()=>Ft.designDevelopment)},get acknowledgements(){return ce(Ft),le(()=>Ft.acknowledgements)}});var at=D(et,2);Tn(at,{get navItems(){return ce(Ft),le(()=>Ft.navItems)},showLeftNav:!1,children:(nt,yt)=>{ea(nt,{get data(){return t(l)},get filterConfig(){return ce(Ft),le(()=>Ft.filterConfig)},get filterOptions(){return t(_)},get chartStats(){return t(q)},get searchState(){return t(z)},get exportState(){return t(m)},get resultsLoading(){return t(R)},get appliedSearchQuery(){return t(y)},get dateField(){return ce(Ft),le(()=>Ft.dateField)},get totalCount(){return t(v)},get hasMore(){return t(c)},onLoadMore:d,onFiltersChange:L,onDownloadCSV:O,showTimeline:!1,showYearNavigation:!1,get categoryDefinitions(){return p},get itemComponent(){return la},displayMode:"table"})},$$slots:{default:!0}}),b(j,P)}});var lt=D(G,2);On(lt),b(r,W),Me()}export{Ta as component};
